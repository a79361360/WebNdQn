

<title>宁德移动流量800支撑平台</title>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js" type="text/javascript"></script>
<script type="text/javascript">
    var sharenum = 1;       //分享次数
    $(function () {
        $("#btn").bind("click", function () {
            var phone = $("#phone").val();   //手机号码
            if (!telRuleCheck2(phone)) { alert("请输入正确的手机号码"); return }
            if (parseInt(sharenum)<1) { alert("请进行分享后再进行兑换"); return }
            var ctype = $(this).getUrlParam("ctype");
            var issue = $(this).getUrlParam("issue");
            $.getJSON("/Home/SignPhoneFilter_gz", { phone: phone,ctype:ctype,issue:issue }, function (ret) {
                alert(ret.msg);
            })
        })
        //手机号码格式验证
        telRuleCheck2 = function (string) {
            var pattern = /^1[34578]\d{9}$/;
            if (pattern.test(string)) {
                return true;
            }
            return false;
        };
        //隐藏遮层
        hidemask = function(){
            _system.$("cover").style.display="none";
            _system.$("guide").style.display="none"; _system.$("cover").onclick=null; window.onresize=null;
        }
        //改变背景
        chg_bg = function(){
            
            var bgurl = '@ViewBag.bg';
            if(bgurl!=""){
                $(".bg")[0].style.backgroundImage="url(../Content/Img/bg_oppo.png)";
            }
        }
        chg_bg();   //初始调用
    })
</script>
<style type="text/css">
    .bg {
        width: 100%;
        background-image: url(../Content/Img/bg_1.png);
        background-repeat: no-repeat;
        background-size: 100%;
        height:0;
        padding-bottom:177.5%;
    }
 .bg2 {
        width: 100%;
        background-image: url(../Content/Img/bg_2.png);
        background-repeat: no-repeat;
        background-size: 100%;
        height:0;
        padding-bottom:177.5%;
    }
    .div_c {
        padding-top:104%;
    }
    .btn_1 {
        background-image: url(../Content/Img/btn_1.png);
        background-size:cover;
        height: 35px;
        width: 85px;
        display:inline-block;
    }
</style>
<style type="text/css">
    #mess_share {
        margin: 15px 0;
    }

    #share_1 {
        float: left;
        width: 49%;
    }

    #share_2 {
        float: right;
        width: 49%;
    }

    #mess_share img {
        width: 22px;
        height: 22px;
    }

    #cover {
        display: none;
        position: absolute;
        left: 0;
        top: 0;
        z-index: 18888;
        background-color: #000000;
        opacity: 0.7;
    }
 #cover1 {
        display: none;
        position: absolute;
        left: 0;
        top: 0;
        z-index: 18888;
        background-color: #000000;
        background-image:url(../Content/Img/bg_2.jpg);
        background-repeat: no-repeat;
        background-size: 100%;
        opacity: 1;
    }
    #guide {
        display: none;
        position: absolute;
        right: 18px;
        top: 5px;
        z-index: 19999;
    }

        #guide img {
            width: 260px;
            height: 180px;
        }
</style>
<div class="bg">
    <form class="form-horizontal div_c" role="form">
            <div class="col-sm-6">
                <input type="tel" class="form-control form-bgc" id="phone" placeholder="请输入你的手机号码" style="width: 60%; margin: 8px auto;">
            </div>
            <div class="col-sm-4" style="text-align:center">
                <span id="btn" class="btn_1"></span>
            </div>
    </form>
</div>
<div id="cover"></div>
<div id="guide"><img src="/Content/Img/guide1.png"></div>
@*<div style="text-align:center;margin:50px 0; font:normal 14px/24px 'MicroSoft YaHei';"></div>*@
<script type="text/javascript">
    $(function () {
        //_system._guide(true);   //调用遮层
        wx.config({
            debug: false,
            appId: '@ViewBag.appid',
            timestamp: @ViewBag.timestamp,
            nonceStr: '@ViewBag.noncestr',
            signature: '@ViewBag.signatrue',
            jsApiList: [
              'checkJsApi',
              'onMenuShareTimeline',
              'onMenuShareAppMessage',
              'onMenuShareQQ',
              'onMenuShareWeibo',
              'onMenuShareQZone',
              'hideMenuItems',
              'showMenuItems',
              'hideAllNonBaseMenuItem',
              'showAllNonBaseMenuItem',
              'translateVoice',
              'startRecord',
              'stopRecord',
              'onVoiceRecordEnd',
              'playVoice',
              'onVoicePlayEnd',
              'pauseVoice',
              'stopVoice',
              'uploadVoice',
              'downloadVoice',
              'chooseImage',
              'previewImage',
              'uploadImage',
              'downloadImage',
              'getNetworkType',
              'openLocation',
              'getLocation',
              'hideOptionMenu',
              'showOptionMenu',
              'closeWindow',
              'scanQRCode',
              'chooseWXPay',
              'openProductSpecificView',
              'addCard',
              'chooseCard',
              'openCard'
            ]
        });
        wx.ready(function () {
            // 2. 分享接口
            // 2.1 监听“分享给朋友”，按钮点击、自定义分享内容及分享结果接口
            wx.onMenuShareAppMessage({
                title: '@ViewBag.title',
                desc: '@ViewBag.desc',
                link: '@ViewBag.linkurl',
                imgUrl: '@ViewBag.imgurl',
                trigger: function (res) {
                    // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回
                    //alert('用户点击发送给朋友');
                },
                success: function (res) {
                    sharenum += 1;
                    hidemask();
                    //alert('已分享');
                },
                cancel: function (res) {
                    //alert('已取消');
                },
                fail: function (res) {
                    alert(JSON.stringify(res));
                }
            });
            // 2.2 监听“分享到朋友圈”按钮点击、自定义分享内容及分享结果接口
            wx.onMenuShareTimeline({
                title: '@ViewBag.title',
                link: '@ViewBag.linkurl',
                imgUrl: '@ViewBag.imgurl',
                trigger: function (res) {
                    // 不要尝试在trigger中使用ajax异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用ajax的回包会还没有返回
                    //alert('用户点击分享到朋友圈');
                },
                success: function (res) {
                    sharenum += 1;
                    hidemask();
                    //alert('已分享');
                },
                cancel: function (res) {
                    //alert('已取消');
                },
                fail: function (res) {
                    alert(JSON.stringify(res));
                }
            });
            // 2.3 监听“分享到QQ”按钮点击、自定义分享内容及分享结果接口
            wx.onMenuShareQQ({
                title: '@ViewBag.title',
                desc: '@ViewBag.desc',
                link: '@ViewBag.linkurl',
                imgUrl: '@ViewBag.imgurl',
                trigger: function (res) {
                    alert('用户点击分享到QQ');
                },
                complete: function (res) {
                    alert(JSON.stringify(res));
                },
                success: function (res) {
                    alert('已分享');
                },
                cancel: function (res) {
                    alert('已取消');
                },
                fail: function (res) {
                    alert(JSON.stringify(res));
                }
            });
        });
    })
    var _system={
        $:function(id){return document.getElementById(id);}, 
        _client:function(){    
            return {
                w:document.documentElement.scrollWidth,h:document.documentElement.scrollHeight,
                bw:document.documentElement.clientWidth,bh:document.documentElement.clientHeight
            }; 
        },  
        _scroll:function(){      
            return {
                x:document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,
                y:document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop
            };  
        },  			 
        _cover:function(show){      
            if(show){    
                this.$("cover").style.display="block";    
                this.$("cover").style.width=(this._client().bw>this._client().w?this._client().bw:this._client().w)+"px";   
                this.$("cover").style.height=(this._client().bh>this._client().h?this._client().bh:this._client().h)+"px"; 
            }else{     
                //this.$("cover").style.display="none";  
            }  
        },  
        _guide:function(click){     
            this._cover(true);     
            this.$("guide").style.display="block";     
            this.$("guide").style.top=(_system._scroll().y+5)+"px";     
            window.onresize=function(){_system._cover(true);_system.$("guide").style.top=(_system._scroll().y+5)+"px";}; 
            if(click){_system.$("cover").onclick=function(){        
                _system._cover();         
                //_system.$("guide").style.display="none"; _system.$("cover").onclick=null; window.onresize=null;  
            };
            } 
        },   
        _zero:function(n){     
            return n<0?0:n;   
        }
    }
</script>
